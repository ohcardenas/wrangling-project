lm(son ~ father , data = galton_heights_2)
galton_heights
galton_heights_2 <- GaltonFamilies %>%
filter( childNum == 1 & gender == "male")%>%
select( father, childHeight)%>%
rename( son = childHeight)
lm(son ~ father , data = galton_heights_2)
library(Lahman)
data("Teams")
galton_heights_2 <- GaltonFamilies %>%
filter( childNum == 1 & gender == "male")%>%
select( father, childHeight)%>%
rename( son = childHeight)
library(tidyverse)
library(dslabs)
library(dplyr)
library(gridExtra)
library(ggrepel)
library(stringr)
library(htmlwidgets)
library(pdftools)
library(purrr)
lm(son ~ father, data = galton_heights_2)
galton_heights_2 <- GaltonFamilies %>%
filter( childNum == 1 & gender == "male")%>%
select( father, childHeight)%>%
rename( son = childHeight)
library(Lahman)
library(Lahman)
data(GaltonFamilies)
install.packages("tidyverse")
library(tidyverse)
library(dslabs)
library(dplyr)
library(gridExtra)
library(ggrepel)
library(stringr)
library(htmlwidgets)
library(pdftools)
library(purrr)
library(tidyverse)
library(lubridate)
library(ggplot2)
library(tidyr)
library(scales)
library(Lahman)
library(tidyverse)
library(dslabs)
library(HistData)
library(HistData)
galton_heights_2 <- GaltonFamilies %>%
filter( childNum == 1 & gender == "male")%>%
select( father, childHeight)%>%
rename( son = childHeight)
lm(son ~ father, data = galton_heights_2)
galton_heights_c <- galton_heights_2 %>%
mutate(father_centered = father- mean(father))
galton_heights_c <- galton_heights_2 %>%
mutate(father_centered = father- mean(father))
lm(son ~ father_centered, data = galton_heights_c)
lm( son ~ father, data = galton_heights_2)
fit <-lm( son ~ father, data = galton_heights_2)
summary(fit)
rss <- function (beta0, beta1, data){
resid <- galton_heights_2$son - (beta0+beta1*galton_heights_2$father)%>%
return(sum(resid^2))
}
beta1 = seq(0, 1, len=nrow(galton_heights_2))
results <- data.frame( beta1 = beta1,
rss = sapply(beta1, rss, beta0 = 25))
results
set.seed(1983, sample.kind = "Rounding")
galton_heights_2 <- GaltonFamilies %>%
filter( gender == "male")%>%
group_by(family)%>%
sample_n(1)%>%
ungroup()%>%
select( father, childHeight)%>%
rename(son = childHeight)
galton_heights_2 <- GaltonFamilies %>%
filter( gender == "male")%>%
group_by(family)%>%
sample_n(1)%>%
ungroup()%>%
select( father, childHeight)%>%
rename(son = childHeight)
results <- data.frame( beta1 = beta1,
rss = sapply(beta1, rss, beta0 = 25))
results
rss <- function (beta0, beta1, data){
resid <- galton_heights_2$son - (beta0+beta1*galton_heights_2$father)%>%
return(sum(resid^2))
}
set.seed(1983, sample.kind = "Rounding")
galton_heights_2 <- GaltonFamilies %>%
filter( gender == "male")%>%
group_by(family)%>%
sample_n(1)%>%
ungroup()%>%
select( father, childHeight)%>%
rename(son = childHeight)
rss <- function (beta0, beta1, data){
resid <- galton_heights_2$son - (beta0+beta1*galton_heights_2$father)%>%
return(sum(resid^2))
}
beta1 = seq(0, 1, len=nrow(galton_heights_2))
results <- data.frame( beta1 = beta1,
rss = sapply(beta1, rss, beta0 = 25))
results
results %>% ggplot(aes(beta1, rss))+geom_line()
results %>% ggplot(aes(beta1, rss))+geom_line()+
geom_line(aes(beta1, rss))
rss <- function (beta0, beta1){
resid <- galton_heights_2$son - (beta0+beta1*galton_heights_2$father)%>%
return(sum(resid^2))
}
rss <- function (beta0, beta1){
resid <- galton_heights_2$son - (beta0+beta1*galton_heights_2$father)%>%
return(sum(resid^2))
}
beta1 = seq(0, 1, len=nrow(galton_heights_2))
results <- data.frame( beta1 = beta1,
rss = sapply(beta1, rss, beta0 = 25))
results
set.seed(1983, sample.kind = "Rounding")
galton_heights_2 <- GaltonFamilies %>%
filter( gender == "male")%>%
group_by(family)%>%
sample_n(1)%>%
ungroup()%>%
select( father, childHeight)%>%
rename(son = childHeight)
rss <- function (beta0, beta1){
resid <- galton_heights_2$son - (beta0+beta1*galton_heights_2$father)%>%
return(sum(resid^2))
}
beta1 = seq(0, 1, len=nrow(galton_heights_2))
results <- data.frame( beta1 = beta1,
rss = sapply(beta1, rss, beta0 = 25))
results %>% ggplot(aes(beta1, rss))+geom_line()+
geom_line(aes(beta1, rss))
library(HistData)
data("GaltonFamilies")
set.seed(1983)
galton_heights <- GaltonFamilies %>%
filter(gender == "male") %>%
group_by(family) %>%
sample_n(1) %>%
ungroup() %>%
select(father, childHeight) %>%
rename(son = childHeight)
rss <- function(beta0, beta1){
resid <- galton_heights$son - (beta0+beta1*galton_heights$father)
return(sum(resid^2))
}
# plot RSS as a function of beta1 when beta0=25
beta1 = seq(0, 1, len=nrow(galton_heights))
results %>% ggplot(aes(beta1, rss)) + geom_line() +
geom_line(aes(beta1, rss))
data("GaltonFamilies")
galton_heights_2 <- GaltonFamilies %>%
filter(gender == "male") %>%
group_by(family) %>%
sample_n(1) %>%
ungroup() %>%
select(father, childHeight) %>%
rename(son = childHeight)
galton_heights_2 <- GaltonFamilies %>%
filter(gender == "male") %>%
group_by(family) %>%
sample_n(1) %>%
ungroup() %>%
select(father, childHeight) %>%
rename(son = childHeight)
rss <- function(beta0, beta1){
resid <- galton_heights_2$son - (beta0+beta1*galton_heights_2$father)
return(sum(resid^2))
}
# plot RSS as a function of beta1 when beta0=25
beta1 = seq(0, 1, len=nrow(galton_heights_2))
results <- data.frame(beta1 = beta1,
rss = sapply(beta1, rss, beta0 = 25))
results %>% ggplot(aes(beta1, rss)) + geom_line() +
geom_line(aes(beta1, rss))
results %>% ggplot(aes(beta1, rss)) + geom_line()
results %>% ggplot(aes(beta1, rss)) + geom_line()
results %>% ggplot(aes(beta1, rss)) + geom_line() +
geom_line(aes(beta1, rss), color = "firebrick")
galton_heights_2 <- GaltonFamilies %>%
filter(gender == "male") %>%
group_by(family) %>%
sample_n(1) %>%
ungroup() %>%
select(father, childHeight) %>%
rename(son = childHeight)
fit <-lm( son ~ father, data = galton_heights_2)
fit
B <- 10000
N <- 50
lse <- replicate(B, {
sample_n(galton_heights_2, N, replace = TRUE)%>%
lm(son ~ father, data = .)%>%
.$coef
})
lse <- data.frame(beta_0 = lse[1,], beta_1 = lse[2,])
lse
library(gridExtra)
p1 <- lse %>% ggplot(aes(aes(beta_0))+ geom_histogram( binwidth = 0.5
p1
p1 <- lse %>% ggplot(aes(beta_0))+ geom_histogram( binwidth = 0.5
, color = "firebrick")
p1
p2 <- lse %>% ggplot(aes(beta_1))+ geom_histogram(binwidth = 0.5
,color = "firebrick")
grid.arrange(p1, p1, ncol = 2)
grid.arrange(p1, p2, ncol = 2)
p2 <- lse %>% ggplot(aes(beta_1))+ geom_histogram(binwidth = 0.5
,color = "firebrick")
grid.arrange(p1, p2, ncol = 2)
p2 <- lse %>% ggplot(aes(beta_1))+ geom_histogram(binwidth = 0.
,color = "firebrick")
p1 <- lse %>% ggplot(aes(beta_0))+ geom_histogram( binwidth = 5
, color = "firebrick")
p2 <- lse %>% ggplot(aes(beta_1))+ geom_histogram(binwidth = 0.1
,color = "firebrick")
grid.arrange(p1, p2, ncol = 2)
sample(galton_heights_2, N, replace = TRUE)%>%
lm(son ~ father, data = .)%>%
summary%>%
.$coef
lse %>% summarise(se_0 = sd(beta_0), se_1 = sd(beta_1))
lse %>% summarise(cor(beta_0, beta_1))
lse_s<- replicate(B, {
sample_n(galton_heights_2, N, replace = TRUE)%>%
mutate(father = father - mean(father))%>%
lm(son ~ father , data = .)%>% .$coef
})
cor(lse[1,], lse[2,])
lse_s <- replicate(B, {
sample_n(galton_heights_2, N, replace = TRUE) %>%
mutate(father = father - mean(father)) %>%
lm(son ~ father , data = .)%>% .$coef
})
cor(lse[1,], lse[2,])
N <-50
B <- 10000
lse_s <- replicate(B, {
sample_n(galton_heights_2, N, replace = TRUE) %>%
mutate(father = father - mean(father)) %>%
lm(son ~ father , data = .)%>% .$coef
})
galton_heights_2 %>% ggplot(aes(father, son))%>%
geom_point()+
geom_smooth(method = "lm")
galton_heights_2 %>% ggplot(aes(father, son)) +
geom_point()+
geom_smooth(method = "lm")
fit <- galton_heights_2 %>% lm(son ~ father , data = .)
Y_hat <- predict(fit , se.fit = TRUE)
fit <- galton_heights_2 %>% lm(son ~ father , data = .)
names(Y_hat)
Y_hat
galton_heights_2 %>% mutate( Y_hat = predict(lm(son ~ father, data = .))) %>%
ggplot(aes(son, Y_hat)) +
geom_line()
results %>% ggplot(aes(beta1, rss)) + geom_line() +
geom_line(aes(beta1, rss), color = "firebrick")
results
